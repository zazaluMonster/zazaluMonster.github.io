---
title: 加快Github Pages服务+Hexo博客的首次加载速度解决方案
tags: Hexo魔改
categories: IT
date: 2019-09-20 15:57:04
---

# 情况分析

国内往GithubPages发送GET请求，很慢，第一次访问的速度在我这边透过浏览器F12工具解析大概是

建立连接（初始化，SSL等等）好几s
等待响应（TTFB）好几s
下载速度倒还行几毫秒


下载到index.html后，浏览器对html进行解析，继续请求html内的各种js，css，字体库等等等等静态资源！

然后我的网页才开始展示！

# 如何解决

1. 访问github很慢，是由于国外网站，而我在国内，不开代理情况下，肯定慢。所以解决方法是让网站备案然后加入CDN，但是好的CDN要钱（万一一个DDOS攻击呵呵），作为一个垃圾个人博客，没必要，暂时先不搞

2. 将所有静态资源托管到国内服务器上，这里有两种选择：
    - 白嫖: 我发现gitee的pages支持跨域访问（目前发现只支持css,js,image资源，不支持字体库，json文件），于是可以在gitee上上传一份hexo的文件，然后在_config.yml中配置一个`baseUrl`，然后在各类模板文件中加上这个`baseUrl`配置，比如我现在是这样的：
    ```yml
    Trusteeship:
        baseUrl: https://your.gitee.io/your.gitee.repo/
    ```
    然后在模板文档里这样搞一下(需要的地方加上前缀))：
    ```html
    <%- css(theme.Trusteeship.baseUrl + 'css/style') %>
    ```
    这个方法总体来看很不错，唯一缺点就是字体库，json文件没法跨域访问，导致加载失败，最后只能把这些加载失败的文件单独重新转到github pages上或者转到你别的托管服务器上了。。这过程中由于我对hexo整体代码架构也不是很熟悉，所以为了一时爽，我直接硬编码了！

    - 托管到自己的服务器上：比如你搞个阿里云轻量服务器，专门搞个后台负责管理静态资源，由于服务器在国内，所以访问肯定不慢。 但是这个方法依旧有个缺点，服务器你要花钱买

# 存在的坑

如果采用上面的第二种方法，工作量会很大，因为你换个主题后，这个主题内的配置你要转移到新主题上，重新配！

暂时就总结这些，有事先闪了！！

